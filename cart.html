<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Корзина — Livi Jewelry</title>
  <meta name="description" content="Корзина и оформление заказа Livi Jewelry.">
  <style>
    :root{ --fg:#111; --muted:#5c5c5c; --line:#eaeaea; --bg:#fff; --radius:20px; --shadow:0 8px 24px rgba(0,0,0,.08); }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{background:#fff;color:#111;font:16px/1.65 system-ui,-apple-system,Segoe UI,Roboto,Arial}
    a{color:inherit;text-decoration:none}
    header{position:sticky;top:0;z-index:40;background:#fff;border-bottom:1px solid var(--line)}
    .nav{max-width:1240px;margin:0 auto;padding:14px 24px;display:flex;align-items:center;justify-content:space-between}
    .brand{font-weight:700;letter-spacing:.08em}
    .nav-right{display:flex;gap:12px;align-items:center}
    .chip{border:1px solid var(--line);border-radius:999px;padding:8px 14px;font-size:14px}
    .cart-link{position:relative;border:1px solid var(--line);border-radius:999px;padding:8px 14px}
    .cart-badge{position:absolute;top:-8px;right:-8px;background:#111;color:#fff;border-radius:999px;font-size:12px;padding:2px 6px;min-width:20px;text-align:center}
    .lang{display:flex;border:1px solid var(--line);border-radius:999px;overflow:hidden}
    .lang button{border:0;background:transparent;padding:8px 12px;font-size:14px;cursor:pointer}
    .lang button.active{background:#111;color:#fff}

    .wrap{max-width:1240px;margin:0 auto;padding:28px 24px;display:grid;grid-template-columns:1.1fr .9fr;gap:24px}
    .card{border:1px solid var(--line);border-radius:var(--radius);background:#fff;overflow:hidden}
    .box{padding:16px}
    h1{font-size:28px;margin-bottom:12px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid var(--line);text-align:left;vertical-align:middle}
    .qty{display:flex;align-items:center;gap:6px}
    .qty button{width:28px;height:28px;border:1px solid var(--line);background:#fff;border-radius:8px;cursor:pointer}
    .totals{display:flex;justify-content:space-between;margin-top:12px;font-weight:600}
    .muted{color:var(--muted)}
    .row{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
    input,textarea{width:100%;border:1px solid var(--line);border-radius:10px;padding:10px;font-size:14px}
    textarea{min-height:88px;resize:vertical}
    .btn{display:inline-block;background:#111;color:#fff;padding:12px 16px;border-radius:999px;border:0;cursor:pointer}
    .btn.alt{background:#fff;color:#111;border:1px solid var(--line)}
    @media (max-width:900px){ .wrap{grid-template-columns:1fr;} }
  </style>
</head>
<body>
<header>
  <div class="nav">
    <a class="brand" href="index.html">LIVI JEWELRY</a>
    <div class="nav-right">
      <a class="chip" href="shop.html" data-ru="Каталог" data-kk="Каталог">Каталог</a>
      <a class="cart-link" href="cart.html" data-ru="Корзина" data-kk="Себет">Корзина<span id="cartCount" class="cart-badge" style="display:none">0</span></a>
      <div class="lang"><button id="ruBtn" class="active">RU</button><button id="kkBtn">KZ</button></div>
    </div>
  </div>
</header>

<div class="wrap">
  <!-- Корзина -->
  <div class="card">
    <div class="box">
      <h1 data-ru="Корзина" data-kk="Себет">Корзина</h1>
      <div id="empty" class="muted" style="display:none" data-ru="Ваша корзина пуста." data-kk="Себетіңіз бос.">Ваша корзина пуста.</div>
      <div style="overflow:auto">
        <table id="table" style="display:none">
          <thead>
            <tr>
              <th data-ru="Товар" data-kk="Тауар">Товар</th>
              <th data-ru="Цена" data-kk="Баға">Цена</th>
              <th data-ru="Кол-во" data-kk="Саны">Кол-во</th>
              <th data-ru="Сумма" data-kk="Сома">Сумма</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>
      <div class="totals" id="totals" style="display:none">
        <div data-ru="Итого" data-kk="Барлығы">Итого</div>
        <div><span id="total">0</span> ₸</div>
      </div>
    </div>
  </div>

  <!-- Оформление -->
  <div class="card">
    <div class="box">
      <h1 data-ru="Оформление заказа" data-kk="Тапсырысты рәсімдеу">Оформление заказа</h1>
      <div class="row">
        <input id="name" placeholder="Имя / Есім">
        <input id="phone" placeholder="+7XXXXXXXXXX">
      </div>
      <div class="row">
        <textarea id="note" placeholder="Комментарий / Ескертпе (размер, пожелания)"></textarea>
      </div>
      <div class="row">
        <button class="btn" id="sendWA" data-ru="Оформить в WhatsApp" data-kk="WhatsApp арқылы рәсімдеу">Оформить в WhatsApp</button>
        <button class="btn alt" id="clear" data-ru="Очистить корзину" data-kk="Себетті тазалау">Очистить корзину</button>
      </div>
      <div class="muted" style="margin-top:6px" data-ru="Мы не списываем деньги на сайте — подтверждаем заказ в WhatsApp."
           data-kk="Сайтта төлем алмаймыз — тапсырысты WhatsApp-та растаймыз.">
           Мы не списываем деньги на сайте — подтверждаем заказ в WhatsApp.
      </div>
    </div>
  </div>
</div>

<footer style="max-width:1240px;margin:16px auto 24px;padding:0 24px;color:#5c5c5c">
  © Livi Jewelry · Қазақстан / Казахстан · <a href="mailto:hello@livijewelry.kz">hello@livijewelry.kz</a>
</footer>

<script>
  // RU/KZ
  const ruBtn=document.getElementById('ruBtn'); const kkBtn=document.getElementById('kkBtn');
  function setLang(lang){
    document.querySelectorAll('[data-ru]').forEach(el=>{ el.textContent = el.getAttribute(lang==='kk' ? 'data-kk' : 'data-ru'); });
    ruBtn.classList.toggle('active', lang!=='kk'); kkBtn.classList.toggle('active', lang==='kk');
    document.documentElement.lang = (lang==='kk'?'kk':'ru'); localStorage.setItem('lang', lang);
  }
  ruBtn.addEventListener('click',()=>setLang('ru')); kkBtn.addEventListener('click',()=>setLang('kk'));
  setLang(localStorage.getItem('lang') || 'ru');

  // Корзина
  const CART_KEY='livi_cart_v1';
  function getCart(){ try{ return JSON.parse(localStorage.getItem(CART_KEY))||[] }catch{ return [] } }
  function setCart(items){ localStorage.setItem(CART_KEY, JSON.stringify(items)); render(); updateCartBadge(); }
  function updateCartBadge(){
    const count=(getCart().reduce((s,i)=>s+i.qty,0))||0;
    const badge=document.getElementById('cartCount');
    if(!badge) return;
    badge.textContent=count;
    badge.style.display = count>0? 'inline-block':'none';
  }

  const tbody=document.getElementById('tbody');
  const table=document.getElementById('table');
  const totals=document.getElementById('totals');
  const empty=document.getElementById('empty');
  const totalEl=document.getElementById('total');

  function fmt(n){ return (n||0).toLocaleString('ru-RU'); }

  function render(){
    const items=getCart();
    tbody.innerHTML='';
    if(items.length===0){
      table.style.display='none'; totals.style.display='none'; empty.style.display='';
      return;
    }
    empty.style.display='none'; table.style.display=''; totals.style.display='';
    let sum=0;
    items.forEach((it,idx)=>{
      const tr=document.createElement('tr');
      tr.innerHTML=`
        <td><div style="display:flex;align-items:center;gap:10px">
          <img src="${it.img}" alt="" style="width:56px;height:70px;object-fit:cover;border:1px solid #eaeaea;border-radius:8px">
          <div>${it.title}</div>
        </div></td>
        <td>${fmt(it.price)} ₸</td>
        <td>
          <div class="qty">
            <button data-dec="${idx}">−</button>
            <div>${it.qty}</div>
            <button data-inc="${idx}">+</button>
          </div>
        </td>
        <td>${fmt(it.price*it.qty)} ₸</td>
        <td><button data-del="${idx}" class="btn alt">×</button></td>
      `;
      tbody.appendChild(tr);
      sum+=it.price*it.qty;
    });
    totalEl.textContent=fmt(sum);

    // обработчики на плюс/минус/удалить
    tbody.querySelectorAll('[data-inc]').forEach(b=>b.addEventListener('click',()=>{
      const i=Number(b.getAttribute('data-inc')); const cart=getCart(); cart[i].qty++; setCart(cart);
    }));
    tbody.querySelectorAll('[data-dec]').forEach(b=>b.addEventListener('click',()=>{
      const i=Number(b.getAttribute('data-dec')); const cart=getCart(); cart[i].qty=Math.max(1,cart[i].qty-1); setCart(cart);
    }));
    tbody.querySelectorAll('[data-del]').forEach(b=>b.addEventListener('click',()=>{
      const i=Number(b.getAttribute('data-del')); const cart=getCart(); cart.splice(i,1); setCart(cart);
    }));
  }

  // Отправка в WhatsApp
  document.getElementById('sendWA').addEventListener('click', ()=>{
    const items=getCart();
    if(items.length===0){ alert('Корзина пуста.'); return; }
    const name=(document.getElementById('name').value||'').trim();
    const phone=(document.getElementById('phone').value||'').trim();
    const note=(document.getElementById('note').value||'').trim();

    const lines=[];
    lines.push('*Новый заказ с сайта Livi Jewelry*');
    if(name) lines.push(`Имя: ${name}`);
    if(phone) lines.push(`Телефон: ${phone}`);
    lines.push('');
    let total=0;
    items.forEach(i=>{
      const line=`• ${i.title} — ${i.price} ₸ × ${i.qty} = ${i.price*i.qty} ₸`;
      lines.push(line); total+=i.price*i.qty;
    });
    lines.push('');
    if(note) lines.push(`Комментарий: ${note}`);
    lines.push(`Итого: ${total} ₸`);
    lines.push('');
    lines.push('Источник: https://leonkanadec37-jpg.github.io/');

    const msg=encodeURIComponent(lines.join('\n'));
    const wa=`https://wa.me/77054510584?text=${msg}`;
    window.open(wa,'_blank');
  });

  document.getElementById('clear').addEventListener('click', ()=>{
    if(confirm('Очистить корзину?')){ setCart([]); }
  });

  // init
  render(); updateCartBadge();
</script>
</body>
</html>
